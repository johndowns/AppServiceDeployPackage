name: $(BuildID)

steps:

  - task: DotNetCoreCLI@2
    displayName: Build Code
    inputs:
      projects: src/EmptyApp.sln

  - task: DotNetCoreCLI@2
    displayName: Package Binaries
    inputs:
      command: publish
      publishWebProjects: true
      projects: src/*.csproj
      arguments: --output $(Build.ArtifactStagingDirectory)/MyApp --no-restore
  
  - task: ArchiveFiles@2
    displayName: Create Zip File
    inputs:
      rootFolderOrFile: $(Build.ArtifactStagingDirectory)/MyApp
      includeRootFolder: false
      archiveFile: $(Build.ArtifactStagingDirectory)/MyApp.zip

  - task: PublishBuildArtifacts@1
    displayName: Publish App
    inputs:
      pathToPublish: $(Build.ArtifactStagingDirectory)/MyApp.zip
      artifactName: myapp
      artifactType: container
 